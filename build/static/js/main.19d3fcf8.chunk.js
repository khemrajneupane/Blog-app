(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{15:function(e,t,a){},17:function(e,t,a){e.exports=a(40)},40:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(16),c=a.n(l),o=a(1),s=a.n(o),u=a(2),i=a(5),m=a(4),d=a.n(m),b=function(){var e;return s.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.awrap(d.a.get("/api/blogs"));case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}))},f=function(e,t){var a,n;return s.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return a={headers:{Authorization:"bearer ".concat(t)}},r.next=3,s.a.awrap(d.a.post("/api/blogs",e,a));case 3:return n=r.sent,r.abrupt("return",n);case 5:case"end":return r.stop()}}))},p=function(e){return"bearer ".concat(e)},v=function(e,t){var a={headers:{Authorization:"bearer ".concat(t)}};return d.a.delete("".concat("/api/blogs","/").concat(e),a)},h=function(e,t){var a,n;return s.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return(a=Object(i.a)({},t)).likes++,r.next=4,s.a.awrap(d.a.put("".concat("/api/blogs","/").concat(e),a));case 4:return n=r.sent,r.abrupt("return",n.data);case 6:case"end":return r.stop()}}))},g=function(e){var t;return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.a.awrap(d.a.post("/api/login",e));case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}))},E=(a(15),function(e){var t=Object(n.useState)([]),a=Object(u.a)(t,2),l=a[0],c=a[1],o=Object(n.useState)(!1),m=Object(u.a)(o,2),d=m[0],b=m[1],f={display:d?"none":""},p={display:d?"":"none"},v=function(){b(!d)},g=e.blogs.map((function(t){var a=t.user.username.indexOf(e.user)>-1;return r.a.createElement("div",{key:t.title,className:"blogStyle form-row","data-testid":"visible"},r.a.createElement("span",{style:f,onClick:v,className:"ptr"},t.title),r.a.createElement("div",{key:t.id,onClick:function(){return function(e){return s.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.awrap(c({title:e.title,author:e.author,url:e.url,likes:e.likes,user:e.user,id:e.id}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}))}(t)},className:"ptr form-group col-md-6","data-testid":"createItems"},t.author,a?r.a.createElement("button",{className:"btn btn-danger",style:{marginLeft:"150px",display:"inline-block"},onClick:function(){return e.deleteList(t,c)}},"remove"):r.a.createElement("button",{className:"hide"}),r.a.createElement("hr",null)))}));return r.a.createElement("div",null,r.a.createElement("div",{style:{position:"fixed",marginLeft:"-40%"},"data-testid":"eachitems"},void 0===l.title?r.a.createElement("div",{className:"hide","data-testid":"invisible"}):r.a.createElement("div",{className:"card text-center","data-testid":"revisible"},r.a.createElement("div",{className:"card-header",style:p,onClick:v,"data-testid":"spanvisible"},l.title),r.a.createElement("div",{className:"card-body"},r.a.createElement("label",null,"Follow:")," ",r.a.createElement("a",{href:l.url},l.url)),"".concat(l.likes," likes "),r.a.createElement("button",{className:"card-text btn btn-primary",onClick:function(){return function(e){var t;return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,(t=Object(i.a)({},e)).likes++,a.next=5,s.a.awrap(h(t.id,e));case 5:c(t),a.next=17;break;case 8:if(a.prev=8,a.t0=a.catch(0),alert(),!0!==window.confirm("".concat(a.t0.message,"! Would you like to refresh?"))){a.next=16;break}window.location.reload(),a.next=17;break;case 16:return a.abrupt("return");case 17:case"end":return a.stop()}}),null,null,[[0,8]])}(l)}},"like"),r.a.createElement("small",null," added by ".concat(l.author)))),r.a.createElement("div",null,g))}),y=function(e){var t=Object(n.useState)(""),a=Object(u.a)(t,2),r=a[0],l=a[1];return{type:e,value:r,onChange:function(e){l(e.target.value)},reset:function(){l("")}}},w=function(e){var t=e.type,a=e.text,n=e.onClick;return r.a.createElement("button",{className:"btn btn-primary",type:t,onClick:n},a)},x=function(e){var t=e.onSubmit,a=y("username"),n=y("password");return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({username:a.value,password:n.value})}},r.a.createElement("div",{className:"form-group col-md-6"},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement("input",Object.assign({className:"form-control"},a,{reset:""})),r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",Object.assign({className:"form-control"},n,{reset:""})),r.a.createElement("br",null),r.a.createElement(w,{type:"submit",text:"Login"}))))},k=function(e){var t=e.inputValue,a=e.handler,n=e.type,l=e.placeholder;return r.a.createElement("input",{value:t,onChange:a,placeholder:l,type:n})},O=function(e){var t=e.onSubmit,a=e.handleTitle,n=e.handleAuthor,l=e.handleUrl,c=e.handleLikes;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:t},r.a.createElement("div",{className:"form-group"},r.a.createElement(k,{className:"form-control",placeholder:"title",value:"title",handler:a})," ",r.a.createElement("br",null),r.a.createElement(k,{className:"form-control",placeholder:"author",value:"author",handler:n}),r.a.createElement("br",null),r.a.createElement(k,{className:"form-control",placeholder:"url",value:"url",type:"url",handler:l}),r.a.createElement("br",null),r.a.createElement(k,{className:"form-control",placeholder:"likes",type:"number",value:"likes",handler:c}),r.a.createElement("br",null),r.a.createElement(w,{style:{marginTop:"5px"},type:"submit",text:"Create"}))))},N=function(){return r.a.createElement(w,{onClick:function(){return window.localStorage.removeItem("loggedUser")?window.location.reload(!0):window.location.reload(!1)},text:"logout"})},j=r.a.forwardRef((function(e,t){var a=Object(n.useState)(!1),l=Object(u.a)(a,2),c=l[0],o=l[1],s={display:c?"none":""},i={display:c?"":"none"},m=function(){o(!c)};return Object(n.useImperativeHandle)(t,(function(){return{toggleVisibility:m}})),r.a.createElement("div",{className:"form-row container"},r.a.createElement("div",{className:"form-group col-md-6",style:s},r.a.createElement("button",{className:"btn btn-primary",onClick:m},e.buttonLabel)),r.a.createElement("div",{style:i},e.children,r.a.createElement("button",{className:"btn btn-primary",onClick:m},e.label)))}));j.displayName="Togglable";var S=j,L=function(e){return r.a.createElement("div",{style:{marginLeft:"40%"}},r.a.createElement("div",{className:"row"},r.a.createElement("p",{className:"col-12"},"".concat(e.user.toUpperCase()," is logged in")," ",r.a.createElement(N,null)),r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{style:{marginTop:"5px"}},r.a.createElement(S,{buttonLabel:"ShowAllBlogs",label:"HideAllBlogs"},"All blogs ",r.a.createElement(E,{blogs:e.blogs,deleteList:e.deleteList,user:e.user}))),r.a.createElement("div",{style:{marginTop:"5px"}},r.a.createElement(S,{buttonLabel:"AddNewBlog",label:"cancel"},r.a.createElement("h6",{className:"form-row container"},"Add Blogs"),r.a.createElement(O,{onSubmit:e.onSubmit,handleTitle:e.handleTitle,handleAuthor:e.handleAuthor,handleUrl:e.handleUrl,handleLikes:e.handleLikes}))))))},C=function(){var e=Object(n.useState)([]),t=Object(u.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(null),o=Object(u.a)(c,2),i=o[0],m=o[1],d=Object(n.useState)(null),h=Object(u.a)(d,2),E=h[0],y=h[1],w=Object(n.useState)(null),k=Object(u.a)(w,2),O=k[0],N=k[1],j=Object(n.useState)(""),S=Object(u.a)(j,2),C=S[0],A=S[1],T=Object(n.useState)(""),U=Object(u.a)(T,2),I=U[0],B=U[1],J=Object(n.useState)(""),F=Object(u.a)(J,2),M=F[0],z=F[1],D=Object(n.useState)(0),H=Object(u.a)(D,2),P=H[0],V=H[1],Y=function(){setTimeout((function(){y(null),N(null)}),5e3)};Object(n.useEffect)((function(){b().then((function(e){l(e)}))}),[a]),a.sort((function(e,t){return t.likes-e.likes})),Object(n.useEffect)((function(){var e=window.localStorage.getItem("loggedUser");if(e){var t=JSON.parse(e);m(t),p(t.token)}}),[i]);return r.a.createElement("div",{className:"flex"},null!==E||null!==O?r.a.createElement((function(e){var t=e.message,a=e.errorMessage;return null===t||null!==a?r.a.createElement("div",{className:"errorMessage"},a):null!==t||null===a?r.a.createElement("div",{className:"message"},t):void 0}),{message:E,errorMessage:O}):null,null===i?r.a.createElement(x,{onSubmit:function(e){var t;return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,s.a.awrap(g(e));case 3:t=a.sent,window.localStorage.setItem("loggedUser",JSON.stringify(t)),p(t.token),m(t),a.next=13;break;case 9:a.prev=9,a.t0=a.catch(0),N("Incorrect username or password"),Y();case 13:case"end":return a.stop()}}),null,null,[[0,9]])}}):r.a.createElement(L,{deleteList:function(e,t){var n,r,c;return s.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(n=e.id,r=e.author,!0!==(c=window.confirm("delete ".concat(r," ?")))){o.next=21;break}return o.prev=3,o.next=6,s.a.awrap(v(n,i.token));case 6:y("Information of ".concat(r," has been removed from the server.")),Y(),t({}),o.next=16;break;case 11:o.prev=11,o.t0=o.catch(3),l(a),N("You have no permission to delete ".concat(r," from the server.\n            Please refresh the page and try again!")),Y();case 16:l(a.filter((function(e){return e.id!==n}))),y("".concat(r,"'s entry has been erased")),Y(),o.next=25;break;case 21:if(!1!==c){o.next=25;break}return y("You did not cancel ".concat(r,"'s entry")),Y(),o.abrupt("return");case 25:case"end":return o.stop()}}),null,null,[[3,11]])},user:i.username,blogs:a,onSubmit:function(e){var t,n,r,c;return s.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(e.preventDefault(),t={title:I,author:M,url:C,likes:P,user:i},n=a.map((function(e){return e.author.indexOf(t.author)})),r=n.indexOf(0)>-1,t.title&&t.author&&t.url){o.next=10;break}N("one or many fields missing!"),Y(),l(a),o.next=34;break;case 10:if(!r){o.next=18;break}return o.next=13,s.a.awrap(a.filter((function(e){return!e.author.indexOf(t.author)}))[0]);case 13:c=o.sent,N("".concat(c.author," is already existing in the database")),Y(),o.next=34;break;case 18:return o.prev=18,o.next=21,s.a.awrap(f(t,i.token));case 21:l(a.concat(t)),y("a new blog ".concat(t.title," by ").concat(t.author," added ")),Y(),B(""),z(""),A(""),V(""),o.next=34;break;case 30:o.prev=30,o.t0=o.catch(18),N(o.t0.message),Y();case 34:case"end":return o.stop()}}),null,null,[[18,30]])},handleTitle:function(e){B(e.target.value)},handleAuthor:function(e){z(e.target.value)},handleUrl:function(e){A(e.target.value)},handleLikes:function(e){V(Number(e.target.value))}}))};c.a.render(r.a.createElement(C,null),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.19d3fcf8.chunk.js.map