(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{15:function(e,t,a){},17:function(e,t,a){e.exports=a(40)},40:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(16),c=a.n(l),s=a(1),o=a.n(s),u=a(2),i=a(5),m=a(4),d=a.n(m),b=function(){var e;return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.awrap(d.a.get("/api/blogs"));case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}))},f=function(e,t){var a,n;return o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return a={headers:{Authorization:"bearer ".concat(t)}},r.next=3,o.a.awrap(d.a.post("/api/blogs",e,a));case 3:return n=r.sent,r.abrupt("return",n);case 5:case"end":return r.stop()}}))},p=function(e){return"bearer ".concat(e)},v=function(e,t){var a={headers:{Authorization:"bearer ".concat(t)}};return d.a.delete("".concat("/api/blogs","/").concat(e),a)},h=function(e,t){var a,n;return o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return(a=Object(i.a)({},t)).likes++,r.next=4,o.a.awrap(d.a.put("".concat("/api/blogs","/").concat(e),a));case 4:return n=r.sent,r.abrupt("return",n.data);case 6:case"end":return r.stop()}}))},g=function(e){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.a.awrap(d.a.post("/api/login",e));case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}))},E=(a(15),function(e){var t=Object(n.useState)([]),a=Object(u.a)(t,2),l=a[0],c=a[1],s=Object(n.useState)(!1),m=Object(u.a)(s,2),d=m[0],b=m[1],f={display:d?"none":""},p={display:d?"":"none"},v=function(){b(!d)},g=e.blogs.map((function(t){var a=t.user.username.indexOf(e.user)>-1;return r.a.createElement("div",{key:t.title,className:"blogStyle form-row","data-testid":"visible"},r.a.createElement("span",{style:f,onClick:v,className:"ptr"},t.title),r.a.createElement("div",{key:t.id,onClick:function(){return function(e){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.awrap(c({title:e.title,author:e.author,url:e.url,likes:e.likes,user:e.user,id:e.id}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}))}(t)},className:"ptr form-group col-md-6","data-testid":"createItems"},t.author,a?r.a.createElement("button",{className:"btn btn-danger",style:{marginLeft:"150px",display:"inline-block"},onClick:function(){return e.deleteList(t,c)}},"remove"):r.a.createElement("button",{className:"hide"}),r.a.createElement("hr",null)))}));return r.a.createElement("div",{className:"d-flex flex-column mb-4"},r.a.createElement("div",{className:"p-2 flex-fill","data-testid":"eachitems"},void 0===l.title?r.a.createElement("div",{className:"hide","data-testid":"invisible"}):r.a.createElement("div",{className:"card text-center jumbotron","data-testid":"revisible"},r.a.createElement("div",{className:"card-header",style:p,onClick:v,"data-testid":"spanvisible"},l.title),r.a.createElement("div",{className:"card-body"},r.a.createElement("label",null,"Follow:")," ",r.a.createElement("a",{href:l.url},l.url)),"".concat(l.likes," likes "),r.a.createElement("button",{className:"card-text btn btn-primary",onClick:function(){return function(e){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,(t=Object(i.a)({},e)).likes++,a.next=5,o.a.awrap(h(t.id,e));case 5:c(t),a.next=17;break;case 8:if(a.prev=8,a.t0=a.catch(0),alert(),!0!==window.confirm("".concat(a.t0.message,"! Would you like to refresh?"))){a.next=16;break}window.location.reload(),a.next=17;break;case 16:return a.abrupt("return");case 17:case"end":return a.stop()}}),null,null,[[0,8]])}(l)}},"like"),r.a.createElement("small",null," added by ".concat(l.author)))),r.a.createElement("div",{className:"p-2 flex-fill"},g))}),x=function(e){var t=Object(n.useState)(""),a=Object(u.a)(t,2),r=a[0],l=a[1];return{type:e,value:r,onChange:function(e){l(e.target.value)},reset:function(){l("")}}},y=function(e){var t=e.type,a=e.text,n=e.onClick;return r.a.createElement("button",{className:"btn btn-primary",type:t,onClick:n},a)},w=function(e){var t=e.onSubmit,a=x("username"),n=x("password");return r.a.createElement("div",{className:"jumbotron",style:{alignItems:"center",marginLeft:"20%",marginRight:"50%"}},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({username:a.value,password:n.value})}},r.a.createElement("div",{className:"form-group col-md-6"},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement("input",Object.assign({className:"form-control"},a,{reset:""})),r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",Object.assign({className:"form-control"},n,{reset:""})),r.a.createElement("br",null),r.a.createElement(y,{type:"submit",text:"Login"}))))},k=function(e){var t=e.inputValue,a=e.handler,n=e.type,l=e.placeholder;return r.a.createElement("input",{value:t,onChange:a,placeholder:l,type:n})},N=function(e){var t=e.onSubmit,a=e.handleTitle,n=e.handleAuthor,l=e.handleUrl,c=e.handleLikes;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:t},r.a.createElement("div",{className:"form-group"},r.a.createElement(k,{className:"form-control",placeholder:"title",value:"title",handler:a})," ",r.a.createElement("br",null),r.a.createElement(k,{className:"form-control",placeholder:"author",value:"author",handler:n}),r.a.createElement("br",null),r.a.createElement(k,{className:"form-control",placeholder:"url",value:"url",type:"url",handler:l}),r.a.createElement("br",null),r.a.createElement(k,{className:"form-control",placeholder:"likes",type:"number",value:"likes",handler:c}),r.a.createElement("br",null),r.a.createElement(y,{style:{marginTop:"5px"},type:"submit",text:"Create"}))))},O=function(){return r.a.createElement(y,{onClick:function(){return window.localStorage.removeItem("loggedUser")?window.location.reload(!0):window.location.reload(!1)},text:"logout"})},j=r.a.forwardRef((function(e,t){var a=Object(n.useState)(!1),l=Object(u.a)(a,2),c=l[0],s=l[1],o={display:c?"none":""},i={display:c?"":"none"},m=function(){s(!c)};return Object(n.useImperativeHandle)(t,(function(){return{toggleVisibility:m}})),r.a.createElement("div",{className:"form-row container"},r.a.createElement("div",{className:"form-group col-md-6",style:o},r.a.createElement("button",{className:"btn btn-primary",onClick:m},e.buttonLabel)),r.a.createElement("div",{style:i},e.children,r.a.createElement("button",{className:"btn btn-primary",onClick:m},e.label)))}));j.displayName="Togglable";var S=j,L=function(e){return r.a.createElement("div",{className:"card jumbotron",style:{alignItems:"center",marginLeft:"90px",marginRight:"90px"}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12",style:{marginLeft:"38px"}},r.a.createElement(O,null)),r.a.createElement("p",{className:"col-12"},"".concat(e.user.toUpperCase()," is logged in")),r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{style:{marginTop:"10px"}},r.a.createElement(S,{buttonLabel:"ShowAllBlogs",label:"HideAllBlogs"},"All blogs ",r.a.createElement(E,{blogs:e.blogs,deleteList:e.deleteList,user:e.user}))),r.a.createElement("div",{style:{marginTop:"10px"}},r.a.createElement(S,{buttonLabel:"AddNewBlog",label:"cancel"},r.a.createElement("h6",{className:"form-row container"},"Add Blogs"),r.a.createElement(N,{onSubmit:e.onSubmit,handleTitle:e.handleTitle,handleAuthor:e.handleAuthor,handleUrl:e.handleUrl,handleLikes:e.handleLikes}))))))},C=function(){var e=Object(n.useState)([]),t=Object(u.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(null),s=Object(u.a)(c,2),i=s[0],m=s[1],d=Object(n.useState)(null),h=Object(u.a)(d,2),E=h[0],x=h[1],y=Object(n.useState)(null),k=Object(u.a)(y,2),N=k[0],O=k[1],j=Object(n.useState)(""),S=Object(u.a)(j,2),C=S[0],A=S[1],I=Object(n.useState)(""),T=Object(u.a)(I,2),U=T[0],B=T[1],J=Object(n.useState)(""),F=Object(u.a)(J,2),M=F[0],R=F[1],z=Object(n.useState)(0),D=Object(u.a)(z,2),H=D[0],P=D[1],V=function(){setTimeout((function(){x(null),O(null)}),5e3)};Object(n.useEffect)((function(){b().then((function(e){l(e)}))}),[a]),a.sort((function(e,t){return t.likes-e.likes})),Object(n.useEffect)((function(){var e=window.localStorage.getItem("loggedUser");if(e){var t=JSON.parse(e);m(t),p(t.token)}}),[m]);return r.a.createElement("div",{className:"flex"},null!==E||null!==N?r.a.createElement((function(e){var t=e.message,a=e.errorMessage;return null===t||null!==a?r.a.createElement("div",{className:"errorMessage"},a):null!==t||null===a?r.a.createElement("div",{className:"message"},t):void 0}),{message:E,errorMessage:N}):null,null===i?r.a.createElement(w,{onSubmit:function(e){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,o.a.awrap(g(e));case 3:t=a.sent,window.localStorage.setItem("loggedUser",JSON.stringify(t)),p(t.token),m(t),a.next=13;break;case 9:a.prev=9,a.t0=a.catch(0),O("Incorrect username or password"),V();case 13:case"end":return a.stop()}}),null,null,[[0,9]])}}):r.a.createElement(L,{deleteList:function(e,t){var n,r,c;return o.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(n=e.id,r=e.author,!0!==(c=window.confirm("delete ".concat(r," ?")))){s.next=21;break}return s.prev=3,s.next=6,o.a.awrap(v(n,i.token));case 6:x("Information of ".concat(r," has been removed from the server.")),V(),t({}),s.next=16;break;case 11:s.prev=11,s.t0=s.catch(3),l(a),O("You have no permission to delete ".concat(r," from the server.\n            Please refresh the page and try again!")),V();case 16:l(a.filter((function(e){return e.id!==n}))),x("".concat(r,"'s entry has been erased")),V(),s.next=25;break;case 21:if(!1!==c){s.next=25;break}return x("You did not cancel ".concat(r,"'s entry")),V(),s.abrupt("return");case 25:case"end":return s.stop()}}),null,null,[[3,11]])},user:i.username,blogs:a,onSubmit:function(e){var t,n,r,c;return o.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(e.preventDefault(),t={title:U,author:M,url:C,likes:H,user:i},n=a.map((function(e){return e.author.indexOf(t.author)})),r=n.indexOf(0)>-1,t.title&&t.author&&t.url){s.next=10;break}O("one or many fields missing!"),V(),l(a),s.next=34;break;case 10:if(!r){s.next=18;break}return s.next=13,o.a.awrap(a.filter((function(e){return!e.author.indexOf(t.author)}))[0]);case 13:c=s.sent,O("".concat(c.author," is already existing in the database")),V(),s.next=34;break;case 18:return s.prev=18,s.next=21,o.a.awrap(f(t,i.token));case 21:l(a.concat(t)),x("a new blog ".concat(t.title," by ").concat(t.author," added ")),V(),B(""),R(""),A(""),P(""),s.next=34;break;case 30:s.prev=30,s.t0=s.catch(18),O(s.t0.message),V();case 34:case"end":return s.stop()}}),null,null,[[18,30]])},handleTitle:function(e){B(e.target.value)},handleAuthor:function(e){R(e.target.value)},handleUrl:function(e){A(e.target.value)},handleLikes:function(e){P(Number(e.target.value))}}))};c.a.render(r.a.createElement(C,null),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.5e63fd19.chunk.js.map